SecRule REQUEST_FILENAME "!@pmFromFile snort2modsec2_static.data" "phase:2,nolog,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,skipAfter:END_SNORT_RULES"

# (sid 2011145) ET WEB_SERVER 3Com Intelligent Management Center Cross Site Scripting Attempt
SecRule REQUEST_URI_RAW "(?i:\/imc\/login\.jsf)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011145,rev:2,msg:'ET WEB_SERVER 3Com Intelligent Management Center Cross Site Scripting Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2011145'"
SecRule REQUEST_URI_RAW "@contains loginForm" "chain"
SecRule ARGS:javax.faces.ViewState "(?i:ViewState\x3D.+(script|alert|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange))" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER 3Com Intelligent Management Center Cross Site Scripting Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2002900) ET WEB_SERVER CGI AWstats Migrate Command Attempt
SecRule REQUEST_URI_RAW "(?i:\/awstats\.pl)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2002900,rev:5,msg:'ET WEB_SERVER CGI AWstats Migrate Command Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2002900'"
SecRule REQUEST_URI_RAW "@contains /migrate" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:migrate\s*=\s*\|)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER CGI AWstats Migrate Command Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009714) ET WEB_SERVER Script tag in URI, Possible Cross Site Scripting Attempt
SecRule REQUEST_URI_RAW "@contains </script>" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009714,rev:4,msg:'ET WEB_SERVER Script tag in URI, Possible Cross Site Scripting Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2009714',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Script tag in URI, Possible Cross Site Scripting Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009715) ET WEB_SERVER Onmouseover= in URI - Likely Cross Site Scripting Attempt
SecRule ARGS_NAMES "(?i:onmouseover)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009715,rev:4,msg:'ET WEB_SERVER Onmouseover= in URI - Likely Cross Site Scripting Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2009715',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Onmouseover= in URI - Likely Cross Site Scripting Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010229) ET WEB_SERVER Possible Cherokee Web Server GET AUX Request Denial Of Service Attempt
SecRule REQUEST_URI_RAW "@contains GET |2F|AUX HTTP|2F|1|2E|" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010229,rev:2,msg:'ET WEB_SERVER Possible Cherokee Web Server GET AUX Request Denial Of Service Attempt',tag:'attempted-dos',tag:'url,doc.emergingthreats.net/2010229',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Cherokee Web Server GET AUX Request Denial Of Service Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2004556) ET WEB_SERVER Cisco CallManager XSS Attempt serverlist.asp pattern
SecRule REQUEST_URI_RAW "(?i:\/CCMAdmin\/serverlist\.asp)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2004556,rev:7,msg:'ET WEB_SERVER Cisco CallManager XSS Attempt serverlist.asp pattern',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2004556'"
SecRule ARGS:pattern "(?i:<?(java|vb)?script>?.*<.+\/script>?)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Cisco CallManager XSS Attempt serverlist.asp pattern',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2002376) ET WEB_SERVER IBM Lotus Domino BaseTarget XSS attempt
SecRule REQUEST_URI_RAW "@contains OpenForm" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2002376,rev:9,msg:'ET WEB_SERVER IBM Lotus Domino BaseTarget XSS attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2002376'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:BaseTarget=.*?\x22)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER IBM Lotus Domino BaseTarget XSS attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2002377) ET WEB_SERVER IBM Lotus Domino Src XSS attempt
SecRule REQUEST_URI_RAW "@contains OpenFrameSet" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2002377,rev:8,msg:'ET WEB_SERVER IBM Lotus Domino Src XSS attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2002377'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:src=.*\x22><\/FRAMESET>.*<script>.*<\/script>)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER IBM Lotus Domino Src XSS attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009361) ET WEB_SERVER cmd.exe In URI - Possible Command Execution Attempt
SecRule REQUEST_URI_RAW "(?i:\/cmd\.exe)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009361,rev:4,msg:'ET WEB_SERVER cmd.exe In URI - Possible Command Execution Attempt',tag:'attempted-recon',tag:'url,doc.emergingthreats.net/2009361',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER cmd.exe In URI - Possible Command Execution Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009362) ET WEB_SERVER /system32/ in Uri - Possible Protected Directory Access Attempt
SecRule REQUEST_URI_RAW "@contains /system32/" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009362,rev:4,msg:'ET WEB_SERVER /system32/ in Uri - Possible Protected Directory Access Attempt',tag:'attempted-recon',tag:'url,doc.emergingthreats.net/2009362',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER /system32/ in Uri - Possible Protected Directory Access Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009363) ET WEB_SERVER Suspicious Chmod Usage in URI
SecRule QUERY_STRING|REQUEST_BODY "(?i:chmod\s+([+-][rwx]|[0-7]))" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009363,rev:6,msg:'ET WEB_SERVER Suspicious Chmod Usage in URI',tag:'attempted-admin',tag:'url,doc.emergingthreats.net/2009363',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Suspicious Chmod Usage in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2008171) ET WEB_SERVER HP OpenView Network Node Manager CGI Directory Traversal
SecRule REQUEST_URI_RAW "(?i:\/OpenView5\.exe)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2008171,rev:5,msg:'ET WEB_SERVER HP OpenView Network Node Manager CGI Directory Traversal',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2008171'"
SecRule REQUEST_URI_RAW "@contains GET " "chain"
SecRule REQUEST_URI_RAW "@contains /OvCgi/" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains Action=../../" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains  HTTP/1" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER HP OpenView Network Node Manager CGI Directory Traversal',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010687) ET WEB_SERVER HP OpenView Network Node Manager Snmp.exe CGI Buffer Overflow Attempt
SecRule REQUEST_URI_RAW "(?i:\/OvCgi\/Main\/Snmp\.exe)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010687,rev:4,msg:'ET WEB_SERVER HP OpenView Network Node Manager Snmp.exe CGI Buffer Overflow Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010687'"
SecRule REQUEST_URI_RAW "@contains GET " "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains Host=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains Oid=" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER HP OpenView Network Node Manager Snmp.exe CGI Buffer Overflow Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010704) ET WEB_SERVER Possible HP OpenView Network Node Manager ovalarm.exe CGI Buffer Overflow Attempt
SecRule REQUEST_URI_RAW "(?i:\/OvCgi\/ovalarm\.exe)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010704,rev:3,msg:'ET WEB_SERVER Possible HP OpenView Network Node Manager ovalarm.exe CGI Buffer Overflow Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010704'"
SecRule REQUEST_URI_RAW "@contains GET " "chain"
SecRule ARGS:OVABverbose "(?i:Accept\-Language\\x3A\\x20)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible HP OpenView Network Node Manager ovalarm.exe CGI Buffer Overflow Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010864) ET WEB_SERVER HP OpenView /OvCgi/Toolbar.exe Accept Language Heap Buffer Overflow Attempt
SecRule REQUEST_URI_RAW "(?i:\/OvCgi\/Toolbar\.exe)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010864,rev:4,msg:'ET WEB_SERVER HP OpenView /OvCgi/Toolbar.exe Accept Language Heap Buffer Overflow Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010864'"
SecRule REQUEST_URI_RAW "@contains POST " "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:Accept\-Language\\x3A)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:Content\-Length\\x3A)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER HP OpenView /OvCgi/Toolbar.exe Accept Language Heap Buffer Overflow Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010970) ET WEB_SERVER HP OpenView Network Node Manager OvWebHelp.exe Heap Buffer Overflow Attempt
SecRule REQUEST_URI_RAW "(?i:\/OvCgi\/OvWebHelp\.exe)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010970,rev:2,msg:'ET WEB_SERVER HP OpenView Network Node Manager OvWebHelp.exe Heap Buffer Overflow Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010970'"
SecRule REQUEST_URI_RAW "@contains POST " "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains Topic=" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER HP OpenView Network Node Manager OvWebHelp.exe Heap Buffer Overflow Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2001365) ET WEB_SERVER Alternate Data Stream source view attempt
SecRule REQUEST_URI_RAW "@contains |3A 3A|$DATA" "phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2001365,rev:10,msg:'ET WEB_SERVER Alternate Data Stream source view attempt',tag:'web-application-activity',tag:'url,doc.emergingthreats.net/2001365',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Alternate Data Stream source view attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2001343) ET WEB_SERVER IIS ASP.net Auth Bypass / Canonicalization % 5 C
SecRule REQUEST_URI_RAW "(?i:\.aspx)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2001343,rev:21,msg:'ET WEB_SERVER IIS ASP.net Auth Bypass / Canonicalization % 5 C',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2001343'"
SecRule QUERY_STRING|REQUEST_BODY "@contains GET" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\\x5C)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains aspx" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER IIS ASP.net Auth Bypass / Canonicalization % 5 C',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010592) ET WEB_SERVER Possible Microsoft Internet Information Services (IIS) .asp Filename Extension Parsing File Upload Security Bypass Attempt (asp)
SecRule REQUEST_URI_RAW "@contains .asp|3B 2E|" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010592,rev:6,msg:'ET WEB_SERVER Possible Microsoft Internet Information Services (IIS) .asp Filename Extension Parsing File Upload Security Bypass Attempt (asp)',tag:'web-application-attack',tag:'cve,2009-4444',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Microsoft Internet Information Services (IIS) .asp Filename Extension Parsing File Upload Security Bypass Attempt (asp)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010593) ET WEB_SERVER Possible Microsoft Internet Information Services (IIS) .aspx Filename Extension Parsing File Upload Security Bypass Attempt (aspx)
SecRule REQUEST_URI_RAW "@contains .aspx|3B 2E|" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010593,rev:6,msg:'ET WEB_SERVER Possible Microsoft Internet Information Services (IIS) .aspx Filename Extension Parsing File Upload Security Bypass Attempt (aspx)',tag:'web-application-attack',tag:'cve,2009-4444',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Microsoft Internet Information Services (IIS) .aspx Filename Extension Parsing File Upload Security Bypass Attempt (aspx)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010379) ET WEB_SERVER JBOSS/JMX REMOTE WAR deployment attempt (POST)
SecRule REQUEST_URI_RAW "@contains POST " "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010379,rev:4,msg:'ET WEB_SERVER JBOSS/JMX REMOTE WAR deployment attempt (POST)',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010379'"
SecRule REQUEST_URI_RAW "@contains /jmx-console/HtmlAdaptor" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains action=invokeOp&name=jboss.deployment" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:flavor\\x253DURL\\x252Ctype\\x253DDeploymentScanner)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\=http\\x3A\\x2F\\x2F)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER JBOSS/JMX REMOTE WAR deployment attempt (POST)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010380) ET WEB_SERVER JBOSS/JMX REMOTE WAR deployment attempt (GET)
SecRule REQUEST_URI_RAW "@contains GET " "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010380,rev:5,msg:'ET WEB_SERVER JBOSS/JMX REMOTE WAR deployment attempt (GET)',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010380'"
SecRule REQUEST_URI_RAW "@contains /jmx-console/HtmlAdaptor?action=invokeOpByName&name=jboss.deployment" "chain"
SecRule REQUEST_URI_RAW "@contains DeploymentScanner" "chain"
SecRule REQUEST_URI_RAW "@contains methodName=addURL" "chain"
SecRule REQUEST_URI_RAW "@contains =http" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER JBOSS/JMX REMOTE WAR deployment attempt (GET)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010863) ET WEB_SERVER LANDesk Command Injection Attempt
SecRule REQUEST_URI_RAW "(?i:\/gsb\/datetime\.php)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010863,rev:4,msg:'ET WEB_SERVER LANDesk Command Injection Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010863'"
SecRule REQUEST_URI_RAW "@contains POST " "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains delBackupName" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains backupRestoreFormSubmitted" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER LANDesk Command Injection Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2002777) ET WEB_SERVER Light Weight Calendar 'date' Arbitrary Remote Code Execution
SecRule QUERY_STRING|REQUEST_BODY "@contains /index.php?" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2002777,rev:6,msg:'ET WEB_SERVER Light Weight Calendar \'date\' Arbitrary Remote Code Execution',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2002777'"
SecRule QUERY_STRING|REQUEST_BODY "@contains date=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:date=\d{8}\)\;.)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Light Weight Calendar \'date\' Arbitrary Remote Code Execution',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010004) ET WEB_SERVER SQL sp_start_job attempt
SecRule QUERY_STRING|REQUEST_BODY "@contains sp_start_job" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010004,rev:4,msg:'ET WEB_SERVER SQL sp_start_job attempt',tag:'attempted-user',tag:'url,doc.emergingthreats.net/2010004',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER SQL sp_start_job attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2000105) ET WEB_SERVER SQL sp_password attempt
SecRule QUERY_STRING|REQUEST_BODY "@contains sp_password" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2000105,rev:4,msg:'ET WEB_SERVER SQL sp_password attempt',tag:'attempted-user',tag:'url,doc.emergingthreats.net/2000105',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER SQL sp_password attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2000106) ET WEB_SERVER SQL sp_delete_alert attempt
SecRule QUERY_STRING|REQUEST_BODY "@contains sp_delete_alert" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2000106,rev:4,msg:'ET WEB_SERVER SQL sp_delete_alert attempt',tag:'attempted-user',tag:'url,doc.emergingthreats.net/2000106',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER SQL sp_delete_alert attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009815) ET WEB_SERVER Attempt To Access MSSQL xp_cmdshell Stored Procedure Via URI
SecRule REQUEST_URI_RAW "@contains EXEC" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009815,rev:4,msg:'ET WEB_SERVER Attempt To Access MSSQL xp_cmdshell Stored Procedure Via URI',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2009815'"
SecRule REQUEST_URI_RAW "@contains xp_cmdshell" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Attempt To Access MSSQL xp_cmdshell Stored Procedure Via URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009816) ET WEB_SERVER Attempt To Access MSSQL xp_servicecontrol Stored Procedure Via URI
SecRule REQUEST_URI_RAW "@contains EXEC" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009816,rev:4,msg:'ET WEB_SERVER Attempt To Access MSSQL xp_servicecontrol Stored Procedure Via URI',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2009816'"
SecRule REQUEST_URI_RAW "@contains xp_servicecontrol" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:(start|stop|continue|pause|querystate))" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Attempt To Access MSSQL xp_servicecontrol Stored Procedure Via URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009817) ET WEB_SERVER Attempt To Access MSSQL sp_adduser Stored Procedure Via URI to Create New Database User
SecRule REQUEST_URI_RAW "@contains EXEC" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009817,rev:4,msg:'ET WEB_SERVER Attempt To Access MSSQL sp_adduser Stored Procedure Via URI to Create New Database User',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2009817'"
SecRule REQUEST_URI_RAW "@contains sp_adduser" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Attempt To Access MSSQL sp_adduser Stored Procedure Via URI to Create New Database User',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009818) ET WEB_SERVER Attempt To Access MSSQL xp_regread/xp_regwrite/xp_regdeletevalue/xp_regdeletekey Stored Procedure Via URI to Modify Registry
SecRule REQUEST_URI_RAW "@contains EXEC" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009818,rev:4,msg:'ET WEB_SERVER Attempt To Access MSSQL xp_regread/xp_regwrite/xp_regdeletevalue/xp_regdeletekey Stored Procedure Via URI to Modify Registry',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2009818'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:xp_reg(read|write|delete))" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Attempt To Access MSSQL xp_regread/xp_regwrite/xp_regdeletevalue/xp_regdeletekey Stored Procedure Via URI to Modify Registry',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009819) ET WEB_SERVER Attempt To Access MSSQL xp_fileexist Stored Procedure Via URI to Locate Files On Disk
SecRule REQUEST_URI_RAW "@contains EXEC" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009819,rev:4,msg:'ET WEB_SERVER Attempt To Access MSSQL xp_fileexist Stored Procedure Via URI to Locate Files On Disk',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2009819'"
SecRule REQUEST_URI_RAW "@contains xp_fileexist" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Attempt To Access MSSQL xp_fileexist Stored Procedure Via URI to Locate Files On Disk',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009820) ET WEB_SERVER Attempt To Access MSSQL xp_enumerrorlogs Stored Procedure Via URI to View Error Logs
SecRule REQUEST_URI_RAW "@contains EXEC" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009820,rev:4,msg:'ET WEB_SERVER Attempt To Access MSSQL xp_enumerrorlogs Stored Procedure Via URI to View Error Logs',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2009820'"
SecRule REQUEST_URI_RAW "@contains xp_enumerrorlogs" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Attempt To Access MSSQL xp_enumerrorlogs Stored Procedure Via URI to View Error Logs',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009822) ET WEB_SERVER Attempt To Access MSSQL xp_readerrorlogs Stored Procedure Via URI to View Error Logs
SecRule REQUEST_URI_RAW "@contains EXEC" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009822,rev:4,msg:'ET WEB_SERVER Attempt To Access MSSQL xp_readerrorlogs Stored Procedure Via URI to View Error Logs',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2009822'"
SecRule REQUEST_URI_RAW "@contains xp_readerrorlogs" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Attempt To Access MSSQL xp_readerrorlogs Stored Procedure Via URI to View Error Logs',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009823) ET WEB_SERVER Attempt To Access MSSQL xp_enumdsn/xp_enumgroups/xp_ntsec_enumdomains Stored Procedure Via URI
SecRule REQUEST_URI_RAW "@contains EXEC" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009823,rev:4,msg:'ET WEB_SERVER Attempt To Access MSSQL xp_enumdsn/xp_enumgroups/xp_ntsec_enumdomains Stored Procedure Via URI',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2009823'"
SecRule REQUEST_URI_RAW "@contains xp_" "chain"
SecRule REQUEST_URI_RAW "@contains _enum" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:(xp_enumdsn|xp_enumgroups|xp_ntsec_enumdomains))" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Attempt To Access MSSQL xp_enumdsn/xp_enumgroups/xp_ntsec_enumdomains Stored Procedure Via URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009670) ET WEB_SERVER Nagios statuswml.cgi Remote Arbitrary Shell Command Injection attempt
SecRule REQUEST_URI_RAW "(?i:\/statuswml\.cgi)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009670,rev:8,msg:'ET WEB_SERVER Nagios statuswml.cgi Remote Arbitrary Shell Command Injection attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2009670'"
SecRule REQUEST_URI_RAW "@contains GET " "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:ping\s*=\s*([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}|[^\x26\x0D\x0A]*\x3B))" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Nagios statuswml.cgi Remote Arbitrary Shell Command Injection attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2002133) ET WEB_SERVER Oracle Reports OS Command Injection Attempt
SecRule REQUEST_URI_RAW "@contains GET " "chain,phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2002133,rev:9,msg:'ET WEB_SERVER Oracle Reports OS Command Injection Attempt',tag:'web-application-activity',tag:'url,doc.emergingthreats.net/2002133'"
SecRule ARGS:report "(?i:(showenv|parsequery|rwservlet)\?.*report=.*\.(rdf|rep))" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Oracle Reports OS Command Injection Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011141) ET WEB_SERVER PHP Easteregg Information-Disclosure (phpinfo)
SecRule REQUEST_URI_RAW "@contains ?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011141,rev:2,msg:'ET WEB_SERVER PHP Easteregg Information-Disclosure (phpinfo)',tag:'attempted-recon',tag:'url,doc.emergingthreats.net/2011141',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP Easteregg Information-Disclosure (phpinfo)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011142) ET WEB_SERVER PHP Easteregg Information-Disclosure (php-logo)
SecRule REQUEST_URI_RAW "@contains ?=PHPE9568F34-D428-11d2-A769-00AA001ACF42" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011142,rev:2,msg:'ET WEB_SERVER PHP Easteregg Information-Disclosure (php-logo)',tag:'attempted-recon',tag:'url,doc.emergingthreats.net/2011142',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP Easteregg Information-Disclosure (php-logo)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011143) ET WEB_SERVER PHP Easteregg Information-Disclosure (zend-logo)
SecRule REQUEST_URI_RAW "@contains ?=PHPE9568F35-D428-11d2-A769-00AA001ACF42" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011143,rev:2,msg:'ET WEB_SERVER PHP Easteregg Information-Disclosure (zend-logo)',tag:'attempted-recon',tag:'url,doc.emergingthreats.net/2011143',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP Easteregg Information-Disclosure (zend-logo)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011144) ET WEB_SERVER PHP Easteregg Information-Disclosure (funny-logo)
SecRule REQUEST_URI_RAW "@contains ?=PHPE9568F36-D428-11d2-A769-00AA001ACF42" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011144,rev:2,msg:'ET WEB_SERVER PHP Easteregg Information-Disclosure (funny-logo)',tag:'attempted-recon',tag:'url,doc.emergingthreats.net/2011144',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP Easteregg Information-Disclosure (funny-logo)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010920) ET WEB_SERVER Exploit Suspected PHP Injection Attack (cmd=)
SecRule REQUEST_URI_RAW "(?i:\.php)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010920,rev:4,msg:'ET WEB_SERVER Exploit Suspected PHP Injection Attack (cmd=)',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010920'"
SecRule REQUEST_URI_RAW "@contains GET " "chain"
SecRule ARGS:cmd "(?i:cmd=[^\x28]*(cd|\;|echo|cat|perl|curl|wget|id|uname|t?ftp))" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Exploit Suspected PHP Injection Attack (cmd=)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009152) ET WEB_SERVER PHP Generic Remote File Include Attempt (HTTPS)
SecRule REQUEST_URI_RAW "(?i:\.php)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009152,rev:7,msg:'ET WEB_SERVER PHP Generic Remote File Include Attempt (HTTPS)',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2009152'"
SecRule REQUEST_URI_RAW "@contains =https|3a|/" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\x2Ephp\x3F.{0,300}\x3Dhttps\x3A\x2F[^\x3F\x26]+\x3F)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP Generic Remote File Include Attempt (HTTPS)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009153) ET WEB_SERVER PHP Generic Remote File Include Attempt (FTP)
SecRule REQUEST_URI_RAW "(?i:\.php)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009153,rev:7,msg:'ET WEB_SERVER PHP Generic Remote File Include Attempt (FTP)',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2009153'"
SecRule REQUEST_URI_RAW "@contains =ftp|3a|/" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\x2Ephp\x3F.{0,300}\x3Dftp\x3A\x2F[^\x3F\x26]+\x3F)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP Generic Remote File Include Attempt (FTP)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009155) ET WEB_SERVER PHP Generic Remote File Include Attempt (FTPS)
SecRule REQUEST_URI_RAW "(?i:\.php)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009155,rev:7,msg:'ET WEB_SERVER PHP Generic Remote File Include Attempt (FTPS)',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2009155'"
SecRule REQUEST_URI_RAW "@contains =ftps\:/" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\x2Ephp\x3F.{0,300}\x3Dftp\x3A\x2F[^\x3F\x26]+\x3F)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP Generic Remote File Include Attempt (FTPS)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2002997) ET WEB_SERVER PHP Remote File Inclusion (monster list http)
SecRule QUERY_STRING|REQUEST_BODY "@contains .php" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2002997,rev:9,msg:'ET WEB_SERVER PHP Remote File Inclusion (monster list http)',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2002997'"
SecRule QUERY_STRING|REQUEST_BODY "@contains http" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\.php.+(path|page|lib|dir|file|root|icon|lang(uage)?|folder|type|agenda|gallery|domain|calendar|settings|news|name|auth|prog|config|cfg|incl|ext|fad|mod|sbp|rf|id|df|[a-z](\[.*\])+)\s*=\s*https?)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP Remote File Inclusion (monster list http)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2006443) ET WEB_SERVER Possible SQL Injection Attempt DELETE FROM
SecRule QUERY_STRING|REQUEST_BODY "(?i:DELETE.+FROM)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2006443,rev:9,msg:'ET WEB_SERVER Possible SQL Injection Attempt DELETE FROM',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2006443',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible SQL Injection Attempt DELETE FROM',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2006444) ET WEB_SERVER Possible SQL Injection Attempt INSERT INTO
SecRule QUERY_STRING|REQUEST_BODY "(?i:INSERT.+INTO)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2006444,rev:9,msg:'ET WEB_SERVER Possible SQL Injection Attempt INSERT INTO',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2006444',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible SQL Injection Attempt INSERT INTO',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2006445) ET WEB_SERVER Possible SQL Injection Attempt SELECT FROM
SecRule QUERY_STRING|REQUEST_BODY "(?i:SELECT.+FROM)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2006445,rev:9,msg:'ET WEB_SERVER Possible SQL Injection Attempt SELECT FROM',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2006445',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible SQL Injection Attempt SELECT FROM',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2006446) ET WEB_SERVER Possible SQL Injection Attempt UNION SELECT
SecRule QUERY_STRING|REQUEST_BODY "(?i:UNION.+SELECT)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2006446,rev:10,msg:'ET WEB_SERVER Possible SQL Injection Attempt UNION SELECT',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2006446',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible SQL Injection Attempt UNION SELECT',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2006447) ET WEB_SERVER Possible SQL Injection Attempt UPDATE SET
SecRule QUERY_STRING|REQUEST_BODY "(?i:[&\?].*UPDATE.+SET\x20*[A-Za-z0-9]*\x20*\x3d)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2006447,rev:11,msg:'ET WEB_SERVER Possible SQL Injection Attempt UPDATE SET',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2006447',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible SQL Injection Attempt UPDATE SET',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010037) ET WEB_SERVER Possible SQL Injection INTO OUTFILE Arbitrary File Write Attempt
SecRule QUERY_STRING|REQUEST_BODY "(?i:INTO.+OUTFILE)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010037,rev:2,msg:'ET WEB_SERVER Possible SQL Injection INTO OUTFILE Arbitrary File Write Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010037',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible SQL Injection INTO OUTFILE Arbitrary File Write Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010084) ET WEB_SERVER Possible ALTER SQL Injection Attempt
SecRule QUERY_STRING|REQUEST_BODY "(?i:ALTER\ +(database|procedure|table|column))" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010084,rev:3,msg:'ET WEB_SERVER Possible ALTER SQL Injection Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010084',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible ALTER SQL Injection Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010085) ET WEB_SERVER Possible DROP SQL Injection Attempt
SecRule QUERY_STRING|REQUEST_BODY "(?i:DROP\ +(database|procedure|table|column))" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010085,rev:3,msg:'ET WEB_SERVER Possible DROP SQL Injection Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010085',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible DROP SQL Injection Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010086) ET WEB_SERVER Possible CREATE SQL Injection Attempt in URI
SecRule QUERY_STRING|REQUEST_BODY "(?i:CREATE\ +(database|procedure|table|column|directory))" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010086,rev:4,msg:'ET WEB_SERVER Possible CREATE SQL Injection Attempt in URI',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010086',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible CREATE SQL Injection Attempt in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010284) ET WEB_SERVER SELECT INSTR in URI, Possible ORACLE Related Blind SQL Injection Attempt
SecRule QUERY_STRING|REQUEST_BODY "(?i:SELECT.+INSTR)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010284,rev:2,msg:'ET WEB_SERVER SELECT INSTR in URI, Possible ORACLE Related Blind SQL Injection Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010284',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER SELECT INSTR in URI, Possible ORACLE Related Blind SQL Injection Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010285) ET WEB_SERVER SELECT SUBSTR/ING in URI, Possible Blind SQL Injection Attempt
SecRule QUERY_STRING|REQUEST_BODY "(?i:SELECT.+SUBSTR)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010285,rev:4,msg:'ET WEB_SERVER SELECT SUBSTR/ING in URI, Possible Blind SQL Injection Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010285',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER SELECT SUBSTR/ING in URI, Possible Blind SQL Injection Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010963) ET WEB_SERVER SELECT USER SQL Injection Attempt in URI
SecRule QUERY_STRING|REQUEST_BODY "(?i:SELECT[^a-z].+USER)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010963,rev:3,msg:'ET WEB_SERVER SELECT USER SQL Injection Attempt in URI',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010963',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER SELECT USER SQL Injection Attempt in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010964) ET WEB_SERVER SHOW CHARACTER SET SQL Injection Attempt in URI
SecRule QUERY_STRING|REQUEST_BODY "@contains SET" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010964,rev:2,msg:'ET WEB_SERVER SHOW CHARACTER SET SQL Injection Attempt in URI',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010964'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:SHOW.+CHARACTER.+SET)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER SHOW CHARACTER SET SQL Injection Attempt in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010965) ET WEB_SERVER SHOW VARIABLES SQL Injection Attempt in URI
SecRule QUERY_STRING|REQUEST_BODY "(?i:SHOW.+VARIABLES)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010965,rev:2,msg:'ET WEB_SERVER SHOW VARIABLES SQL Injection Attempt in URI',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010965',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER SHOW VARIABLES SQL Injection Attempt in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010966) ET WEB_SERVER SHOW CURDATE/CURTIME SQL Injection Attempt in URI
SecRule QUERY_STRING|REQUEST_BODY "(?i:SHOW.+CUR(DATE|TIME))" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010966,rev:2,msg:'ET WEB_SERVER SHOW CURDATE/CURTIME SQL Injection Attempt in URI',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010966',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER SHOW CURDATE/CURTIME SQL Injection Attempt in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010967) ET WEB_SERVER SHOW TABLES SQL Injection Attempt in URI
SecRule QUERY_STRING|REQUEST_BODY "(?i:SHOW.+TABLES)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010967,rev:2,msg:'ET WEB_SERVER SHOW TABLES SQL Injection Attempt in URI',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010967',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER SHOW TABLES SQL Injection Attempt in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011035) ET WEB_SERVER SQL Injection BULK INSERT in URI to Insert File Content into Database Table
SecRule QUERY_STRING|REQUEST_BODY "(?i:BULK.+?INSERT)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011035,rev:3,msg:'ET WEB_SERVER SQL Injection BULK INSERT in URI to Insert File Content into Database Table',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2011035',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER SQL Injection BULK INSERT in URI to Insert File Content into Database Table',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011037) ET WEB_SERVER Possible Attempt to Get SQL Server Version in URI using SELECT VERSION
SecRule QUERY_STRING|REQUEST_BODY "(?i:SELECT.+VERSION)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011037,rev:3,msg:'ET WEB_SERVER Possible Attempt to Get SQL Server Version in URI using SELECT VERSION',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2011037',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Attempt to Get SQL Server Version in URI using SELECT VERSION',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011039) ET WEB_SERVER Possible INSERT VALUES SQL Injection Attempt
SecRule QUERY_STRING|REQUEST_BODY "(?i:INSERT.+VALUES)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011039,rev:2,msg:'ET WEB_SERVER Possible INSERT VALUES SQL Injection Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2011039',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible INSERT VALUES SQL Injection Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011041) ET WEB_SERVER MYSQL Benchmark Command in URI to Consume Server Resources
SecRule REQUEST_URI_RAW "@contains BENCHMARK(" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011041,rev:2,msg:'ET WEB_SERVER MYSQL Benchmark Command in URI to Consume Server Resources',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2011041'"
SecRule REQUEST_URI_RAW "@contains )" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:BENCHMARK\x28[0-9].+\x29)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER MYSQL Benchmark Command in URI to Consume Server Resources',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011042) ET WEB_SERVER MYSQL SELECT CONCAT SQL Injection Attempt
SecRule QUERY_STRING|REQUEST_BODY "(?i:SELECT.+CONCAT)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011042,rev:2,msg:'ET WEB_SERVER MYSQL SELECT CONCAT SQL Injection Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2011042',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER MYSQL SELECT CONCAT SQL Injection Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2009485) ET WEB_SERVER /etc/shadow Detected in URI
SecRule REQUEST_URI_RAW "@contains /etc/shadow" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2009485,rev:4,msg:'ET WEB_SERVER /etc/shadow Detected in URI',tag:'attempted-recon',tag:'url,doc.emergingthreats.net/2009485',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER /etc/shadow Detected in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2003903) ET WEB_SERVER Microsoft SharePoint XSS Attempt default.aspx
SecRule REQUEST_URI_RAW "(?i:\/default\.aspx)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2003903,rev:7,msg:'ET WEB_SERVER Microsoft SharePoint XSS Attempt default.aspx',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2003903'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:<?(java|vb)?script>?.*<.+\/script>?)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Microsoft SharePoint XSS Attempt default.aspx',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2003904) ET WEB_SERVER Microsoft SharePoint XSS Attempt index.php form mail
SecRule REQUEST_URI_RAW "(?i:\/contact\/contact\/index\.php)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2003904,rev:7,msg:'ET WEB_SERVER Microsoft SharePoint XSS Attempt index.php form mail',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2003904'"
SecRule ARGS:form[mail] "(?i:<?(java|vb)?script>?.*<.+\/script>?)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Microsoft SharePoint XSS Attempt index.php form mail',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011073) ET WEB_SERVER Microsoft SharePoint Server 2007 _layouts/help.aspx Cross Site Scripting Attempt
SecRule REQUEST_URI_RAW "(?i:\/_layouts\/help\.aspx)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011073,rev:4,msg:'ET WEB_SERVER Microsoft SharePoint Server 2007 _layouts/help.aspx Cross Site Scripting Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2011073'"
SecRule ARGS:cid0 "(?i:cid0\x3d.+(script|alert|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange))" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Microsoft SharePoint Server 2007 _layouts/help.aspx Cross Site Scripting Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010667) ET WEB_SERVER /bin/bash In URI, Possible Shell Command Execution Attempt Within Web Exploit
SecRule REQUEST_URI_RAW "@contains /bin/bash" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010667,rev:4,msg:'ET WEB_SERVER /bin/bash In URI, Possible Shell Command Execution Attempt Within Web Exploit',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2010667',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER /bin/bash In URI, Possible Shell Command Execution Attempt Within Web Exploit',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011015) ET WEB_SERVER Possible Sun Microsystems Sun Java System Web Server Remote File Disclosure Attempt
SecRule QUERY_STRING|REQUEST_BODY "@contains UNLOCK" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011015,rev:2,msg:'ET WEB_SERVER Possible Sun Microsystems Sun Java System Web Server Remote File Disclosure Attempt',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2011015'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:Connection\\x3A\ Close)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:Lock\-token\\x3A)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Sun Microsystems Sun Java System Web Server Remote File Disclosure Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2002844) ET WEB_SERVER WebDAV search overflow
SecRule QUERY_STRING|REQUEST_BODY "@contains SEARCH " "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2002844,rev:6,msg:'ET WEB_SERVER WebDAV search overflow',tag:'web-application-attack',tag:'url,doc.emergingthreats.net/2002844',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebDAV search overflow',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2002667) ET WEB_SERVER sumthin scan
SecRule REQUEST_URI_RAW "@contains GET " "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2002667,rev:36,msg:'ET WEB_SERVER sumthin scan',tag:'attempted-recon',tag:'url,doc.emergingthreats.net/2002667'"
SecRule REQUEST_URI_RAW "@contains /sumthin" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER sumthin scan',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2010794) ET WEB_SERVER DFind w00tw00t GET-Requests
SecRule REQUEST_URI_RAW "@contains GET " "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2010794,rev:5,msg:'ET WEB_SERVER DFind w00tw00t GET-Requests',tag:'attempted-recon',tag:'url,doc.emergingthreats.net/2010794'"
SecRule REQUEST_URI_RAW "@contains /w00tw00t." "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER DFind w00tw00t GET-Requests',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011464) ET WEB_SERVER /bin/csh In URI Possible Shell Command Execution Attempt
SecRule REQUEST_URI_RAW "@contains /bin/csh" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011464,rev:3,msg:'ET WEB_SERVER /bin/csh In URI Possible Shell Command Execution Attempt',tag:'web-application-attack',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER /bin/csh In URI Possible Shell Command Execution Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011466) ET WEB_SERVER /bin/tsh In URI Possible Shell Command Execution Attempt
SecRule REQUEST_URI_RAW "@contains /bin/tsh" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011466,rev:4,msg:'ET WEB_SERVER /bin/tsh In URI Possible Shell Command Execution Attempt',tag:'web-application-attack',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER /bin/tsh In URI Possible Shell Command Execution Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011467) ET WEB_SERVER /bin/ksh In URI Possible Shell Command Execution Attempt
SecRule REQUEST_URI_RAW "@contains /bin/ksh" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011467,rev:4,msg:'ET WEB_SERVER /bin/ksh In URI Possible Shell Command Execution Attempt',tag:'web-application-attack',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER /bin/ksh In URI Possible Shell Command Execution Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 100000429) GPL WEB_SERVER WEB-MISC JBoss web-console access
SecRule REQUEST_URI_RAW "@contains /web-console" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid100000429,rev:4,msg:'GPL WEB_SERVER WEB-MISC JBoss web-console access',tag:'misc-activity',tag:'url,www.jboss.org/wiki/Wiki.jsp?page=WebConsole',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER WEB-MISC JBoss web-console access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2101350) GPL WEB_SERVER python access attempt
SecRule QUERY_STRING|REQUEST_BODY "@contains python " "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2101350,rev:8,msg:'GPL WEB_SERVER python access attempt',tag:'web-application-attack',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER python access attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2101649) GPL WEB_SERVER perl command attempt
SecRule REQUEST_URI_RAW "(?i:\/perl)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2101649,rev:8,msg:'GPL WEB_SERVER perl command attempt',tag:'attempted-recon',tag:'url,www.cert.org/advisories/CA-1996-11.html',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER perl command attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2101877) GPL WEB_SERVER printenv access
SecRule REQUEST_URI_RAW "@contains /printenv" "phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2101877,rev:9,msg:'GPL WEB_SERVER printenv access',tag:'web-application-activity',tag:'nessus,10503',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER printenv access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2100952) GPL WEB_SERVER author.exe access
SecRule QUERY_STRING|REQUEST_BODY "@contains /_vti_bin/_vti_aut/author.exe" "phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2100952,rev:8,msg:'GPL WEB_SERVER author.exe access',tag:'web-application-activity',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER author.exe access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2100951) GPL WEB_SERVER authors.pwd access
SecRule QUERY_STRING|REQUEST_BODY "@contains /authors.pwd" "phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2100951,rev:11,msg:'GPL WEB_SERVER authors.pwd access',tag:'web-application-activity',tag:'nessus,10078',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER authors.pwd access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2100958) GPL WEB_SERVER service.cnf access
SecRule QUERY_STRING|REQUEST_BODY "@contains /_vti_pvt/service.cnf" "phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2100958,rev:10,msg:'GPL WEB_SERVER service.cnf access',tag:'web-application-activity',tag:'nessus,10575',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER service.cnf access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2100959) GPL WEB_SERVER service.pwd
SecRule QUERY_STRING|REQUEST_BODY "@contains /service.pwd" "phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2100959,rev:8,msg:'GPL WEB_SERVER service.pwd',tag:'web-application-activity',tag:'bugtraq,1205',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER service.pwd',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2100961) GPL WEB_SERVER services.cnf access
SecRule REQUEST_URI_RAW "(?i:\/_vti_pvt\/services\.cnf)" "phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2100961,rev:10,msg:'GPL WEB_SERVER services.cnf access',tag:'web-application-activity',tag:'nessus,10575',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER services.cnf access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2100965) GPL WEB_SERVER writeto.cnf access
SecRule QUERY_STRING|REQUEST_BODY "@contains /_vti_pvt/writeto.cnf" "phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2100965,rev:11,msg:'GPL WEB_SERVER writeto.cnf access',tag:'web-application-activity',tag:'nessus,10575',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER writeto.cnf access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2100994) GPL WEB_SERVER /scripts/iisadmin/default.htm access
SecRule QUERY_STRING|REQUEST_BODY "@contains /scripts/iisadmin/default.htm" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2100994,rev:8,msg:'GPL WEB_SERVER /scripts/iisadmin/default.htm access',tag:'web-application-attack',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER /scripts/iisadmin/default.htm access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2101016) GPL WEB_SERVER global.asa access
SecRule QUERY_STRING|REQUEST_BODY "@contains /global.asa" "phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2101016,rev:14,msg:'GPL WEB_SERVER global.asa access',tag:'web-application-activity',tag:'nessus,10991',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER global.asa access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2100993) GPL WEB_SERVER iisadmin access
SecRule QUERY_STRING|REQUEST_BODY "@contains /iisadmin" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2100993,rev:12,msg:'GPL WEB_SERVER iisadmin access',tag:'web-application-attack',tag:'nessus,11032',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER iisadmin access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2101945) GPL WEB_SERVER unicode directory traversal attempt
SecRule QUERY_STRING|REQUEST_BODY "(?i:\/\.\.\\x255c\.\.)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2101945,rev:7,msg:'GPL WEB_SERVER unicode directory traversal attempt',tag:'web-application-attack',tag:'nessus,10537',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER unicode directory traversal attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2101129) GPL WEB_SERVER .htaccess access
SecRule REQUEST_URI_RAW "@contains .htaccess" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2101129,rev:7,msg:'GPL WEB_SERVER .htaccess access',tag:'attempted-recon',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER .htaccess access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2101071) GPL WEB_SERVER .htpasswd access
SecRule QUERY_STRING|REQUEST_BODY "@contains .htpasswd" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2101071,rev:7,msg:'GPL WEB_SERVER .htpasswd access',tag:'web-application-attack',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER .htpasswd access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2101145) GPL WEB_SERVER /~root access
SecRule REQUEST_URI_RAW "@contains /~root" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2101145,rev:8,msg:'GPL WEB_SERVER /~root access',tag:'attempted-recon',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER /~root access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2101603) GPL WEB_SERVER DELETE attempt
SecRule REQUEST_URI_RAW "@contains DELETE " "phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2101603,rev:10,msg:'GPL WEB_SERVER DELETE attempt',tag:'web-application-activity',tag:'nessus,10498',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER DELETE attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2101874) GPL WEB_SERVER Oracle Java Process Manager access
SecRule REQUEST_URI_RAW "@contains /oprocmgr-status" "phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2101874,rev:3,msg:'GPL WEB_SERVER Oracle Java Process Manager access',tag:'web-application-activity',tag:'nessus,10851',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER Oracle Java Process Manager access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2101055) GPL WEB_SERVER Tomcat directory traversal attempt
SecRule REQUEST_URI_RAW "(?i:\\x00\.jsp)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2101055,rev:10,msg:'GPL WEB_SERVER Tomcat directory traversal attempt',tag:'web-application-attack',tag:'bugtraq,2518',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER Tomcat directory traversal attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2101108) GPL WEB_SERVER Tomcat server snoop access
SecRule REQUEST_URI_RAW "(?i:\.snp)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2101108,rev:11,msg:'GPL WEB_SERVER Tomcat server snoop access',tag:'attempted-recon',tag:'cve,2000-0760'"
SecRule REQUEST_URI_RAW "@contains /jsp/snp/" "ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER Tomcat server snoop access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2101519) GPL WEB_SERVER apache ?M=D directory list attempt
SecRule REQUEST_URI_RAW "@contains /?M=D" "phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2101519,rev:9,msg:'GPL WEB_SERVER apache ?M=D directory list attempt',tag:'web-application-activity',tag:'cve,2001-0731',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER apache ?M=D directory list attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2101403) GPL WEB_SERVER viewcode access
SecRule QUERY_STRING|REQUEST_BODY "@contains /viewcode" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2101403,rev:11,msg:'GPL WEB_SERVER viewcode access',tag:'web-application-attack',tag:'nessus,12048',ctl:auditLogParts=+E,setvar:'tx.msg=GPL WEB_SERVER viewcode access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011358) ET WEB_SERVER ColdFusion Path Traversal (locale 1/5)
SecRule REQUEST_URI_RAW "(?i:\/CFIDE\/wizards\/common\/_logintowizard\.cfm)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011358,rev:1,msg:'ET WEB_SERVER ColdFusion Path Traversal (locale 1/5)',tag:'web-application-attack',tag:'url,www.exploit-db.com/exploits/14641/'"
SecRule REQUEST_URI_RAW "@contains POST " "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:locale\=\\x00\.\.\/\.\.\/)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER ColdFusion Path Traversal (locale 1/5)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011359) ET WEB_SERVER ColdFusion Path Traversal (locale 2/5)
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011359,rev:3,msg:'ET WEB_SERVER ColdFusion Path Traversal (locale 2/5)',tag:'web-application-attack',tag:'url,www.exploit-db.com/exploits/14641/'"
SecRule QUERY_STRING|REQUEST_BODY "@contains /CFIDE/administrator/archives/index.cfm" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains locale=../../" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER ColdFusion Path Traversal (locale 2/5)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011360) ET WEB_SERVER ColdFusion Path Traversal (locale 3/5)
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011360,rev:3,msg:'ET WEB_SERVER ColdFusion Path Traversal (locale 3/5)',tag:'web-application-attack',tag:'url,www.exploit-db.com/exploits/14641/'"
SecRule QUERY_STRING|REQUEST_BODY "@contains /CFIDE/administrator/entman/index.cfm" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains locale=../../" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER ColdFusion Path Traversal (locale 3/5)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011362) ET WEB_SERVER ColdFusion Path Traversal (locale 5/5)
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011362,rev:3,msg:'ET WEB_SERVER ColdFusion Path Traversal (locale 5/5)',tag:'web-application-attack',tag:'url,www.exploit-db.com/exploits/14641/'"
SecRule QUERY_STRING|REQUEST_BODY "@contains /CFIDE/administrator/enter.cfm" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains locale=../../" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER ColdFusion Path Traversal (locale 5/5)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011424) ET WEB_SERVER Possible SQL Injection Using MSSQL sp_configure Command
SecRule REQUEST_URI_RAW "@contains sp_configure" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011424,rev:1,msg:'ET WEB_SERVER Possible SQL Injection Using MSSQL sp_configure Command',tag:'web-application-attack',tag:'url,technet.microsoft.com/en-us/library/ms190693.aspx',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible SQL Injection Using MSSQL sp_configure Command',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2011465) ET WEB_SERVER /bin/sh In URI Possible Shell Command Execution Attempt
SecRule REQUEST_URI_RAW "@contains /bin/sh" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2011465,rev:6,msg:'ET WEB_SERVER /bin/sh In URI Possible Shell Command Execution Attempt',tag:'web-application-attack',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER /bin/sh In URI Possible Shell Command Execution Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2013068) ET WEB_SERVER Possible GRANT TO SQL Injection Attempt
SecRule QUERY_STRING|REQUEST_BODY "(?i:GRANT.{1,5}TO)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2013068,rev:3,msg:'ET WEB_SERVER Possible GRANT TO SQL Injection Attempt',tag:'web-application-attack',tag:'url,beginner-sql-tutorial.com/sql-grant-revoke-privileges-roles.htm',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible GRANT TO SQL Injection Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2013365) ET WEB_SERVER PUT Website Defacement Attempt
SecRule REQUEST_URI_RAW "@contains PUT " "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2013365,rev:2,msg:'ET WEB_SERVER PUT Website Defacement Attempt',tag:'web-application-attack'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\<title\>\.\\x3a\\x3a\[\+\]\ Defaced\ by\ )" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PUT Website Defacement Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2013937) ET WEB_SERVER Weevely PHP backdoor detected (system() function used)
SecRule QUERY_STRING|REQUEST_BODY "@contains QHN5c3Rl" "chain,phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2013937,rev:4,msg:'ET WEB_SERVER Weevely PHP backdoor detected (system() function used)',tag:'web-application-activity',tag:'url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:Referer\\x3a\ http\\x3a\/\/www\.google\.com\/url\?sa\=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Weevely PHP backdoor detected (system() function used)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2013938) ET WEB_SERVER Weevely PHP backdoor detected (passthru() function used)
SecRule QUERY_STRING|REQUEST_BODY "@contains cGFzc3Ro" "chain,phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2013938,rev:3,msg:'ET WEB_SERVER Weevely PHP backdoor detected (passthru() function used)',tag:'web-application-activity',tag:'url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:Referer\\x3a\ http\\x3a\/\/www\.google\.com\/url\?sa\=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Weevely PHP backdoor detected (passthru() function used)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2013939) ET WEB_SERVER Weevely PHP backdoor detected (shell_exec() function used)
SecRule QUERY_STRING|REQUEST_BODY "@contains aGVsbF9l" "chain,phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2013939,rev:3,msg:'ET WEB_SERVER Weevely PHP backdoor detected (shell_exec() function used)',tag:'web-application-activity',tag:'url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:Referer\\x3a\ http\\x3a\/\/www\.google\.com\/url\?sa\=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Weevely PHP backdoor detected (shell_exec() function used)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2013940) ET WEB_SERVER Weevely PHP backdoor detected (proc_open() function used)
SecRule QUERY_STRING|REQUEST_BODY "@contains JHAgPSBhcnJheShhcnJh" "chain,phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2013940,rev:3,msg:'ET WEB_SERVER Weevely PHP backdoor detected (proc_open() function used)',tag:'web-application-activity',tag:'url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:Referer\\x3a\ http\\x3a\/\/www\.google\.com\/url\?sa\=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Weevely PHP backdoor detected (proc_open() function used)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2013941) ET WEB_SERVER Weevely PHP backdoor detected (popen() function used)
SecRule QUERY_STRING|REQUEST_BODY "@contains JGggPSBwb3Bl" "chain,phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2013941,rev:3,msg:'ET WEB_SERVER Weevely PHP backdoor detected (popen() function used)',tag:'web-application-activity',tag:'url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:Referer\\x3a\ http\\x3a\/\/www\.google\.com\/url\?sa\=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Weevely PHP backdoor detected (popen() function used)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2013942) ET WEB_SERVER Weevely PHP backdoor detected (python_eval() function used)
SecRule QUERY_STRING|REQUEST_BODY "@contains QHB5dGhvbl9l" "chain,phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2013942,rev:3,msg:'ET WEB_SERVER Weevely PHP backdoor detected (python_eval() function used)',tag:'web-application-activity',tag:'url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:Referer\\x3a\ http\\x3a\/\/www\.google\.com\/url\?sa\=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Weevely PHP backdoor detected (python_eval() function used)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2013943) ET WEB_SERVER Weevely PHP backdoor detected (pcntl_exec() function used)
SecRule QUERY_STRING|REQUEST_BODY "@contains JGFyZ3MgPSBh" "chain,phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2013943,rev:3,msg:'ET WEB_SERVER Weevely PHP backdoor detected (pcntl_exec() function used)',tag:'web-application-activity',tag:'url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:Referer\\x3a\ http\\x3a\/\/www\.google\.com\/url\?sa\=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Weevely PHP backdoor detected (pcntl_exec() function used)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2013944) ET WEB_SERVER Weevely PHP backdoor detected (perl->system() function used)
SecRule QUERY_STRING|REQUEST_BODY "@contains JHBlcmwgPSBuZXcg" "chain,phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2013944,rev:3,msg:'ET WEB_SERVER Weevely PHP backdoor detected (perl->system() function used)',tag:'web-application-activity',tag:'url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:Referer\\x3a\ http\\x3a\/\/www\.google\.com\/url\?sa\=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Weevely PHP backdoor detected (perl->system() function used)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2013945) ET WEB_SERVER Weevely PHP backdoor detected (exec() function used)
SecRule QUERY_STRING|REQUEST_BODY "@contains ZXhlYygn" "chain,phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2013945,rev:3,msg:'ET WEB_SERVER Weevely PHP backdoor detected (exec() function used)',tag:'web-application-activity',tag:'url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:Referer\\x3a\ http\\x3a\/\/www\.google\.com\/url\?sa\=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Weevely PHP backdoor detected (exec() function used)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2014020) ET WEB_SERVER Wordpress Login Bruteforcing Detected
SecRule QUERY_STRING|REQUEST_BODY "@contains /wp-login.php" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2014020,rev:4,msg:'ET WEB_SERVER Wordpress Login Bruteforcing Detected',tag:'attempted-recon'"
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:log\\x3d)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:pwd\\x3d)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Wordpress Login Bruteforcing Detected',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2014100) ET WEB_SERVER ASP.NET Forms Authentication Bypass
SecRule REQUEST_URI_RAW "(?i:\/CreatingUserAccounts\.aspx)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2014100,rev:3,msg:'ET WEB_SERVER ASP.NET Forms Authentication Bypass',tag:'attempted-user',tag:'cve,2011-3416'"
SecRule QUERY_STRING|REQUEST_BODY "@contains CreateUserStepContainer" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains UserName=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\\x00)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:UserName\x3d[^\x26]+\x2500)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER ASP.NET Forms Authentication Bypass',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2014103) ET WEB_SERVER Unusually Fast HTTP Requests With Referrer Url Matching DoS Tool
SecRule QUERY_STRING|REQUEST_BODY "(?i:Referer\\x3a\\x20http\\x3a\/\/code\.google\.com\/p\/slowhttptest\/)" "phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2014103,rev:2,msg:'ET WEB_SERVER Unusually Fast HTTP Requests With Referrer Url Matching DoS Tool',tag:'web-application-activity',tag:'url,community.qualys.com/blogs/securitylabs/2012/01/05/slow-read',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Unusually Fast HTTP Requests With Referrer Url Matching DoS Tool',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2014296) ET WEB_SERVER eval/base64_decode Exploit Attempt Inbound
SecRule REQUEST_URI_RAW "@contains eval|28|base64_decode|28|" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2014296,rev:2,msg:'ET WEB_SERVER eval/base64_decode Exploit Attempt Inbound',tag:'web-application-attack',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER eval/base64_decode Exploit Attempt Inbound',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2014986) ET WEB_SERVER possible IBM Rational Directory Server (RDS) Help system href browser redirect
SecRule QUERY_STRING|REQUEST_BODY "@contains /rds-help/advanced/deferredView.jsp?" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2014986,rev:1,msg:'ET WEB_SERVER possible IBM Rational Directory Server (RDS) Help system href browser redirect',tag:'web-application-attack',tag:'url,secunia.com/advisories/49627/'"
SecRule QUERY_STRING|REQUEST_BODY "@contains href=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:href=\s*(ftps?|https?|php)\:\/)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER possible IBM Rational Directory Server (RDS) Help system href browser redirect',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2014987) ET WEB_SERVER possible IBM Rational Directory Server (RDS) Help system href Cross Site Scripting Attempt
SecRule QUERY_STRING|REQUEST_BODY "@contains /rds-help/advanced/deferredView.jsp?" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2014987,rev:1,msg:'ET WEB_SERVER possible IBM Rational Directory Server (RDS) Help system href Cross Site Scripting Attempt',tag:'web-application-attack',tag:'url,secunia.com/advisories/49627/'"
SecRule QUERY_STRING|REQUEST_BODY "@contains href=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:href\x3D.+(script|alert|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange|javascript))" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER possible IBM Rational Directory Server (RDS) Help system href Cross Site Scripting Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2015023) ET WEB_SERVER IIS 8.3 Filename With Wildcard (Possible File/Dir Bruteforce)
SecRule QUERY_STRING|REQUEST_BODY "@contains ~1" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2015023,rev:3,msg:'ET WEB_SERVER IIS 8.3 Filename With Wildcard (Possible File/Dir Bruteforce)',tag:'network-scan',tag:'url,soroush.secproject.com/downloadable/microsoft_iis_tilde_character_vulnerability_feature.pdf'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:([\*\?]~1|~1\.?[\*\?]|\/~1\/))" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER IIS 8.3 Filename With Wildcard (Possible File/Dir Bruteforce)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2015035) ET WEB_SERVER possible SAP Crystal Report Server 2008 path parameter Directory Traversal vulnerability
SecRule QUERY_STRING|REQUEST_BODY "@contains /PerformanceManagement/jsp/qa.jsp?" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2015035,rev:1,msg:'ET WEB_SERVER possible SAP Crystal Report Server 2008 path parameter Directory Traversal vulnerability',tag:'web-application-attack',tag:'url,1337day.com/exploits/15332'"
SecRule QUERY_STRING|REQUEST_BODY "@contains func=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains root=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains path=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\\x2e\\x2e\\x2f)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER possible SAP Crystal Report Server 2008 path parameter Directory Traversal vulnerability',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2015625) ET WEB_SERVER Magento XMLRPC-Exploit Attempt
SecRule REQUEST_URI_RAW "@contains POST " "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2015625,rev:2,msg:'ET WEB_SERVER Magento XMLRPC-Exploit Attempt',tag:'web-application-attack',tag:'url,www.exploit-db.com/exploits/19793/'"
SecRule REQUEST_URI_RAW "@contains /api/xmlrpc" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:file\\x3a\\x2f\\x2f\\x2f)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Magento XMLRPC-Exploit Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016153) ET WEB_SERVER WebShell - JSP File Admin - POST Structure - dir
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016153,rev:2,msg:'ET WEB_SERVER WebShell - JSP File Admin - POST Structure - dir',tag:'attempted-user'"
SecRule QUERY_STRING|REQUEST_BODY "@contains dir=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains &sort=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains &command=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains &Submit=" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell - JSP File Admin - POST Structure - dir',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016182) ET WEB_SERVER ColdFusion componentutils access
SecRule QUERY_STRING|REQUEST_BODY "@contains GET" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016182,rev:4,msg:'ET WEB_SERVER ColdFusion componentutils access',tag:'web-application-attack',tag:'url,www.adobe.com/support/security/advisories/apsa13-01.html'"
SecRule QUERY_STRING|REQUEST_BODY "@contains /CFIDE/componentutils" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER ColdFusion componentutils access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016183) ET WEB_SERVER ColdFusion adminapi access
SecRule QUERY_STRING|REQUEST_BODY "@contains GET" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016183,rev:3,msg:'ET WEB_SERVER ColdFusion adminapi access',tag:'web-application-attack',tag:'url,www.adobe.com/support/security/advisories/apsa13-01.html'"
SecRule QUERY_STRING|REQUEST_BODY "@contains /CFIDE/adminapi" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER ColdFusion adminapi access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016184) ET WEB_SERVER ColdFusion administrator access
SecRule QUERY_STRING|REQUEST_BODY "@contains GET" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016184,rev:3,msg:'ET WEB_SERVER ColdFusion administrator access',tag:'web-application-attack',tag:'url,www.adobe.com/support/security/advisories/apsa13-01.html'"
SecRule QUERY_STRING|REQUEST_BODY "@contains /CFIDE/administrator" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER ColdFusion administrator access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016415) ET WEB_SERVER PHP tag in UA
SecRule QUERY_STRING|REQUEST_BODY "@contains <?php" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016415,rev:2,msg:'ET WEB_SERVER PHP tag in UA',tag:'bad-unknown',tag:'url,blog.spiderlabs.com/2013/02/honeypot-alert-user-agent-field-php-injection-attacks.html',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP tag in UA',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016416) ET WEB_SERVER base64_decode in UA
SecRule QUERY_STRING|REQUEST_BODY "@contains base64_decode(" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016416,rev:2,msg:'ET WEB_SERVER base64_decode in UA',tag:'bad-unknown',tag:'url,blog.spiderlabs.com/2013/02/honeypot-alert-user-agent-field-php-injection-attacks.html',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER base64_decode in UA',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016575) ET WEB_SERVER WebShell - MySQL Interface - Client Cookie mysql_web_admin*=
SecRule QUERY_STRING|REQUEST_BODY "@contains mysql_web_admin_" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016575,rev:2,msg:'ET WEB_SERVER WebShell - MySQL Interface - Client Cookie mysql_web_admin*=',tag:'bad-unknown'"
SecRule QUERY_STRING|REQUEST_BODY "@contains mysql_web_admin" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell - MySQL Interface - Client Cookie mysql_web_admin*=',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016641) ET WEB_SERVER Possible Perl Shell in HTTP POST
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016641,rev:6,msg:'ET WEB_SERVER Possible Perl Shell in HTTP POST',tag:'web-application-attack',tag:'url,isc.sans.edu/diary.html?storyid=9478'"
SecRule QUERY_STRING|REQUEST_BODY "@contains #!/usr/bin/perl" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Perl Shell in HTTP POST',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016642) ET WEB_SERVER Possible Perl Shell in HTTP POST
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016642,rev:6,msg:'ET WEB_SERVER Possible Perl Shell in HTTP POST',tag:'web-application-attack',tag:'url,isc.sans.edu/diary.html?storyid=9478'"
SecRule QUERY_STRING|REQUEST_BODY "@contains #!/bin/sh" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Perl Shell in HTTP POST',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016680) ET WEB_SERVER WebShell Generic - net user
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016680,rev:7,msg:'ET WEB_SERVER WebShell Generic - net user',tag:'bad-unknown'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\\x0d\\x0a\\x0d\\x0a)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains net" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains user" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell Generic - net user',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016681) ET WEB_SERVER WebShell Generic - netsh firewall
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016681,rev:2,msg:'ET WEB_SERVER WebShell Generic - netsh firewall',tag:'bad-unknown'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\\x0d\\x0a\\x0d\\x0a)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains netsh" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains firewall" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell Generic - netsh firewall',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016682) ET WEB_SERVER WebShell Generic - reg HKEY_LOCAL_MACHINE
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016682,rev:2,msg:'ET WEB_SERVER WebShell Generic - reg HKEY_LOCAL_MACHINE',tag:'bad-unknown'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\\x0d\\x0a\\x0d\\x0a)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains reg" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains HKEY_LOCAL_MACHINE" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell Generic - reg HKEY_LOCAL_MACHINE',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016683) ET WEB_SERVER WebShell Generic - wget http - POST
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016683,rev:2,msg:'ET WEB_SERVER WebShell Generic - wget http - POST',tag:'bad-unknown'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\\x0d\\x0a\\x0d\\x0a)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains wget" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains http" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell Generic - wget http - POST',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016761) ET WEB_SERVER WebShell - PHPShell - Haxplorer URI
SecRule QUERY_STRING|REQUEST_BODY "@contains .php?&s=r&cmd=dir&dir=" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016761,rev:1,msg:'ET WEB_SERVER WebShell - PHPShell - Haxplorer URI',tag:'attempted-user',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell - PHPShell - Haxplorer URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016762) ET WEB_SERVER WebShell - PHPShell - PHPKonsole URI
SecRule QUERY_STRING|REQUEST_BODY "@contains .php?&s=r&cmd=con" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016762,rev:1,msg:'ET WEB_SERVER WebShell - PHPShell - PHPKonsole URI',tag:'attempted-user',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell - PHPShell - PHPKonsole URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016836) ET WEB_SERVER ColdFusion password.properties access
SecRule QUERY_STRING|REQUEST_BODY "@contains GET" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016836,rev:2,msg:'ET WEB_SERVER ColdFusion password.properties access',tag:'web-application-attack',tag:'url,cxsecurity.com/issue/WLB-2013050065'"
SecRule QUERY_STRING|REQUEST_BODY "@contains password.properties" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER ColdFusion password.properties access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016841) ET WEB_SERVER  ColdFusion path disclosure to get the absolute path
SecRule QUERY_STRING|REQUEST_BODY "@contains GET" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016841,rev:4,msg:'ET WEB_SERVER  ColdFusion path disclosure to get the absolute path',tag:'web-application-attack',tag:'url,www.exploit-db.com/exploits/25305/'"
SecRule QUERY_STRING|REQUEST_BODY "@contains /administrator/analyzer/index.cfm" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\\x2e\\x2e\\x2f)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER  ColdFusion path disclosure to get the absolute path',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016842) ET WEB_SERVER ColdFusion scheduletasks access
SecRule QUERY_STRING|REQUEST_BODY "@contains /CFIDE/administrator/scheduler/scheduletasks.cfm" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016842,rev:1,msg:'ET WEB_SERVER ColdFusion scheduletasks access',tag:'web-application-attack',tag:'url,exploit-db.com/exploits/24946/',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER ColdFusion scheduletasks access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016843) ET WEB_SERVER ColdFusion scheduleedit access
SecRule QUERY_STRING|REQUEST_BODY "@contains /CFIDE/administrator/scheduler/scheduleedit.cfm" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016843,rev:1,msg:'ET WEB_SERVER ColdFusion scheduleedit access',tag:'web-application-attack',tag:'url,exploit-db.com/exploits/24946/',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER ColdFusion scheduleedit access',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016845) ET WEB_SERVER HTTPing Usage Inbound
SecRule QUERY_STRING|REQUEST_BODY "(?i:User\-Agent\\x3a\\x20HTTPing)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016845,rev:1,msg:'ET WEB_SERVER HTTPing Usage Inbound',tag:'policy-violation',tag:'url,www.vanheusden.com/httping/',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER HTTPing Usage Inbound',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016918) ET WEB_SERVER Possible NGINX Overflow CVE-2013-2028 Exploit Specific
SecRule QUERY_STRING|REQUEST_BODY "@contains chunked" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016918,rev:6,msg:'ET WEB_SERVER Possible NGINX Overflow CVE-2013-2028 Exploit Specific',tag:'attempted-admin',tag:'url,github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/nginx_chunked_size.rb',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible NGINX Overflow CVE-2013-2028 Exploit Specific',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016920) ET WEB_SERVER Apache Struts Possible xwork Disable Method Execution
SecRule QUERY_STRING|REQUEST_BODY "@contains xwork" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016920,rev:2,msg:'ET WEB_SERVER Apache Struts Possible xwork Disable Method Execution',tag:'attempted-admin',tag:'url,struts.apache.org/development/2.x/docs/s2-013.html'"
SecRule QUERY_STRING|REQUEST_BODY "@contains MethodAccessor" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains denyMethodExecution" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Apache Struts Possible xwork Disable Method Execution',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016935) ET WEB_SERVER SQL Injection Select Sleep Time Delay
SecRule QUERY_STRING|REQUEST_BODY "@contains SELECT" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016935,rev:2,msg:'ET WEB_SERVER SQL Injection Select Sleep Time Delay',tag:'web-application-attack',tag:'url,pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet'"
SecRule QUERY_STRING|REQUEST_BODY "@contains SLEEP" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\bSELECT.*?\bSLEEP)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER SQL Injection Select Sleep Time Delay',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016936) ET WEB_SERVER SQL Injection Local File Access Attempt Using LOAD_FILE
SecRule QUERY_STRING|REQUEST_BODY "@contains LOAD_FILE(" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016936,rev:2,msg:'ET WEB_SERVER SQL Injection Local File Access Attempt Using LOAD_FILE',tag:'web-application-attack',tag:'url,pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER SQL Injection Local File Access Attempt Using LOAD_FILE',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016977) ET WEB_SERVER allow_url_include PHP config option in uri
SecRule QUERY_STRING|REQUEST_BODY "@contains allow_url_include" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016977,rev:2,msg:'ET WEB_SERVER allow_url_include PHP config option in uri',tag:'trojan-activity',tag:'url,seclists.org/fulldisclosure/2013/Jun/21'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\ballow_url_include\s*?=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER allow_url_include PHP config option in uri',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016978) ET WEB_SERVER safe_mode PHP config option in uri
SecRule QUERY_STRING|REQUEST_BODY "@contains safe_mode" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016978,rev:3,msg:'ET WEB_SERVER safe_mode PHP config option in uri',tag:'trojan-activity',tag:'url,seclists.org/fulldisclosure/2013/Jun/21'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\bsafe_mode\s*?=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER safe_mode PHP config option in uri',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016979) ET WEB_SERVER suhosin.simulation PHP config option in uri
SecRule QUERY_STRING|REQUEST_BODY "@contains suhosin.simulation" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016979,rev:4,msg:'ET WEB_SERVER suhosin.simulation PHP config option in uri',tag:'trojan-activity',tag:'url,seclists.org/fulldisclosure/2013/Jun/21'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\bsuhosin\.simulation\s*?=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER suhosin.simulation PHP config option in uri',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016980) ET WEB_SERVER disable_functions PHP config option in uri
SecRule QUERY_STRING|REQUEST_BODY "(?i:\bdisable_functions[\s\+]*?=)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016980,rev:4,msg:'ET WEB_SERVER disable_functions PHP config option in uri',tag:'trojan-activity',tag:'url,seclists.org/fulldisclosure/2013/Jun/21',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER disable_functions PHP config option in uri',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016981) ET WEB_SERVER open_basedir PHP config option in uri
SecRule QUERY_STRING|REQUEST_BODY "@contains open_basedir" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016981,rev:2,msg:'ET WEB_SERVER open_basedir PHP config option in uri',tag:'trojan-activity',tag:'url,seclists.org/fulldisclosure/2013/Jun/21'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\bopen_basedir\s*?=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER open_basedir PHP config option in uri',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016982) ET WEB_SERVER auto_prepend_file PHP config option in uri
SecRule QUERY_STRING|REQUEST_BODY "@contains auto_prepend_file" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016982,rev:3,msg:'ET WEB_SERVER auto_prepend_file PHP config option in uri',tag:'trojan-activity',tag:'url,seclists.org/fulldisclosure/2013/Jun/21'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\bauto_prepend_file\s*?=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER auto_prepend_file PHP config option in uri',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016983) ET WEB_SERVER Access to /phppath/php Possible Plesk 0-day Exploit June 05 2013
SecRule QUERY_STRING|REQUEST_BODY "@contains /phppath/php" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016983,rev:1,msg:'ET WEB_SERVER Access to /phppath/php Possible Plesk 0-day Exploit June 05 2013',tag:'trojan-activity',tag:'url,seclists.org/fulldisclosure/2013/Jun/21'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\/phppath\/php\b)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Access to /phppath/php Possible Plesk 0-day Exploit June 05 2013',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2016992) ET WEB_SERVER WebShell Generic - *.tar.gz in POST body
SecRule QUERY_STRING|REQUEST_BODY "@contains .tar.gz" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2016992,rev:1,msg:'ET WEB_SERVER WebShell Generic - *.tar.gz in POST body',tag:'bad-unknown',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell Generic - *.tar.gz in POST body',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017010) ET WEB_SERVER Possible SQLi xp_cmdshell POST body
SecRule QUERY_STRING|REQUEST_BODY "@contains xp_cmdshell" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017010,rev:2,msg:'ET WEB_SERVER Possible SQLi xp_cmdshell POST body',tag:'bad-unknown',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible SQLi xp_cmdshell POST body',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017054) ET WEB_SERVER WebShell Generic - ELF File Uploaded
SecRule QUERY_STRING|REQUEST_BODY "(?i:\\x7FELF)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017054,rev:1,msg:'ET WEB_SERVER WebShell Generic - ELF File Uploaded',tag:'bad-unknown',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell Generic - ELF File Uploaded',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017086) ET WEB_SERVER WebShell - GODSpy - MySQL
SecRule QUERY_STRING|REQUEST_BODY "@contains dbhost=" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017086,rev:1,msg:'ET WEB_SERVER WebShell - GODSpy - MySQL',tag:'trojan-activity'"
SecRule QUERY_STRING|REQUEST_BODY "@contains dbuser=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains dbpass=" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell - GODSpy - MySQL',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017088) ET WEB_SERVER WebShell - GODSPy - Auth Creds
SecRule QUERY_STRING|REQUEST_BODY "@contains ctr=" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017088,rev:1,msg:'ET WEB_SERVER WebShell - GODSPy - Auth Creds',tag:'trojan-activity'"
SecRule QUERY_STRING|REQUEST_BODY "@contains haz=pasa" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell - GODSPy - Auth Creds',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017090) ET WEB_SERVER WebShell - Pouya - URI - raiz
SecRule QUERY_STRING|REQUEST_BODY "@contains .asp?raiz=" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017090,rev:1,msg:'ET WEB_SERVER WebShell - Pouya - URI - raiz',tag:'trojan-activity',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell - Pouya - URI - raiz',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017091) ET WEB_SERVER WebShell - Pouya - URI - action=
SecRule QUERY_STRING|REQUEST_BODY "@contains .asp?action=" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017091,rev:2,msg:'ET WEB_SERVER WebShell - Pouya - URI - action=',tag:'trojan-activity'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\.asp\?action=(?:txt(?:edit|view)|upload|info|del)(&|$))" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell - Pouya - URI - action=',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017143) ET WEB_SERVER CRLF Injection - Newline Characters in URL
SecRule REQUEST_URI_RAW "@contains |0D 0A|" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017143,rev:3,msg:'ET WEB_SERVER CRLF Injection - Newline Characters in URL',tag:'web-application-attack',tag:'url,www.owasp.org/index.php/CRLF_Injection'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:[\n\r](content-(type|length)|set-cookie|location)\x3a)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER CRLF Injection - Newline Characters in URL',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017155) ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 redirect
SecRule QUERY_STRING|REQUEST_BODY "@contains .action?" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017155,rev:5,msg:'ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 redirect',tag:'attempted-user',tag:'url,struts.apache.org/release/2.3.x/docs/s2-016.html'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:redirect\\x3a)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains {" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:[\?&]redirect\x3a)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 redirect',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017156) ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 redirectAction
SecRule QUERY_STRING|REQUEST_BODY "@contains .action?" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017156,rev:5,msg:'ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 redirectAction',tag:'attempted-user',tag:'url,struts.apache.org/release/2.3.x/docs/s2-016.html'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:redirectAction\\x3a)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains {" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:[\?&]redirectAction\x3a)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 redirectAction',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017157) ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 action
SecRule QUERY_STRING|REQUEST_BODY "@contains .action?" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017157,rev:5,msg:'ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 action',tag:'attempted-user',tag:'url,struts.apache.org/release/2.3.x/docs/s2-016.html'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:action\\x3a)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains {" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:[\?&]action\x3a)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 action',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017174) ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 redirect
SecRule QUERY_STRING|REQUEST_BODY "@contains .action" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017174,rev:4,msg:'ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 redirect',tag:'attempted-user',tag:'url,struts.apache.org/release/2.3.x/docs/s2-016.html'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:redirect\\x3a)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains {" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 redirect',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017175) ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 redirectAction
SecRule QUERY_STRING|REQUEST_BODY "@contains .action" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017175,rev:3,msg:'ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 redirectAction',tag:'attempted-user',tag:'url,struts.apache.org/release/2.3.x/docs/s2-016.html'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:redirectAction\\x3a)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains {" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 redirectAction',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017176) ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 action
SecRule QUERY_STRING|REQUEST_BODY "@contains .action" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017176,rev:4,msg:'ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 action',tag:'attempted-user',tag:'url,struts.apache.org/release/2.3.x/docs/s2-016.html'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:action\\x3a)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains {" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 action',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017260) ET WEB_SERVER WebShell Generic - ASP File Uploaded
SecRule QUERY_STRING|REQUEST_BODY "(?i:\\x0D\\x0A)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017260,rev:11,msg:'ET WEB_SERVER WebShell Generic - ASP File Uploaded',tag:'trojan-activity'"
SecRule QUERY_STRING|REQUEST_BODY "@contains <%" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains %>" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell Generic - ASP File Uploaded',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017277) ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action
SecRule QUERY_STRING|REQUEST_BODY "@contains /${" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017277,rev:4,msg:'ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action',tag:'attempted-user',tag:'url,cwiki.apache.org/confluence/display/WW/S2-015'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\/\$\{[^\}\x2c]+?=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017278) ET WEB_SERVER Possible Apache Struts OGNL Expression Injection
SecRule QUERY_STRING|REQUEST_BODY "(?i:\\x24\\x7b)" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017278,rev:2,msg:'ET WEB_SERVER Possible Apache Struts OGNL Expression Injection',tag:'web-application-attack',tag:'url,cwiki.apache.org/confluence/display/WW/S2-015'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\\x25\\x7b)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:\\x7d)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:${\s*?%{)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Apache Struts OGNL Expression Injection',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017280) ET WEB_SERVER Possible OpenX Backdoor Backdoor Access POST to flowplayer
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017280,rev:2,msg:'ET WEB_SERVER Possible OpenX Backdoor Backdoor Access POST to flowplayer',tag:'trojan-activity',tag:'url,blog.sucuri.net/2013/08/openx-org-compromised-and-downloads-injected-with-a-backdoor.html'"
SecRule QUERY_STRING|REQUEST_BODY "@contains /flowplayer-3.1.1.min.js" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible OpenX Backdoor Backdoor Access POST to flowplayer',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017293) ET WEB_SERVER - EXE File Uploaded - Hex Encoded
SecRule QUERY_STRING|REQUEST_BODY "@contains 4d5a" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017293,rev:1,msg:'ET WEB_SERVER - EXE File Uploaded - Hex Encoded',tag:'bad-unknown'"
SecRule QUERY_STRING|REQUEST_BODY "@contains 50450000" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER - EXE File Uploaded - Hex Encoded',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017327) ET WEB_SERVER Joomla Upload File Filter Bypass
SecRule QUERY_STRING|REQUEST_BODY "@contains option=com_media" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017327,rev:2,msg:'ET WEB_SERVER Joomla Upload File Filter Bypass',tag:'attempted-user'"
SecRule QUERY_STRING|REQUEST_BODY "@contains Filedata[]" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Joomla Upload File Filter Bypass',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017330) ET WEB_SERVER SQLi - SELECT and sysobject
SecRule QUERY_STRING|REQUEST_BODY "@contains SELECT" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017330,rev:1,msg:'ET WEB_SERVER SQLi - SELECT and sysobject',tag:'attempted-admin'"
SecRule QUERY_STRING|REQUEST_BODY "@contains sysobjects" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER SQLi - SELECT and sysobject',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017337) ET WEB_SERVER ATTACKER SQLi - SELECT and Schema Columns
SecRule QUERY_STRING|REQUEST_BODY "@contains SELECT" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017337,rev:1,msg:'ET WEB_SERVER ATTACKER SQLi - SELECT and Schema Columns',tag:'attempted-user'"
SecRule QUERY_STRING|REQUEST_BODY "@contains information_schema.columns" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER ATTACKER SQLi - SELECT and Schema Columns',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017366) ET WEB_SERVER Coldfusion 9 Auth Bypass CVE-2013-0632
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017366,rev:2,msg:'ET WEB_SERVER Coldfusion 9 Auth Bypass CVE-2013-0632',tag:'attempted-user',tag:'cve,2013-0632'"
SecRule QUERY_STRING|REQUEST_BODY "@contains /adminapi/administrator.cfc?" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains method" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains login" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains rdsPasswordAllowed" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Coldfusion 9 Auth Bypass CVE-2013-0632',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017389) ET WEB_SERVER WebShell - ASPyder - Auth Creds
SecRule QUERY_STRING|REQUEST_BODY "@contains code=" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017389,rev:2,msg:'ET WEB_SERVER WebShell - ASPyder - Auth Creds',tag:'trojan-activity'"
SecRule QUERY_STRING|REQUEST_BODY "@contains &submit=" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell - ASPyder - Auth Creds',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017392) ET WEB_SERVER WebShell - ASPyder - File Browser - POST Structure
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017392,rev:1,msg:'ET WEB_SERVER WebShell - ASPyder - File Browser - POST Structure',tag:'trojan-activity'"
SecRule QUERY_STRING|REQUEST_BODY "@contains txtpath=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains &cmd=" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell - ASPyder - File Browser - POST Structure',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017393) ET WEB_SERVER WebShell - ASPyder -File Upload - POST Structure
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017393,rev:1,msg:'ET WEB_SERVER WebShell - ASPyder -File Upload - POST Structure',tag:'trojan-activity'"
SecRule QUERY_STRING|REQUEST_BODY "@contains ?upload=@&txtpath=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains Upload !" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WebShell - ASPyder -File Upload - POST Structure',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017436) ET WEB_SERVER PHP SERVER SuperGlobal in URI
SecRule QUERY_STRING|REQUEST_BODY "@contains _SERVER[" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017436,rev:2,msg:'ET WEB_SERVER PHP SERVER SuperGlobal in URI',tag:'bad-unknown',tag:'url,imperva.com/download.asp?id=421'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:[&\?]_SERVER\[[^\]]+?\][^=]*?=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP SERVER SuperGlobal in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017437) ET WEB_SERVER PHP GET SuperGlobal in URI
SecRule QUERY_STRING|REQUEST_BODY "@contains _GET[" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017437,rev:2,msg:'ET WEB_SERVER PHP GET SuperGlobal in URI',tag:'bad-unknown',tag:'url,imperva.com/download.asp?id=421'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:[&\?]_GET\[[^\]]+?\][^=]*?=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP GET SuperGlobal in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017438) ET WEB_SERVER PHP POST SuperGlobal in URI
SecRule QUERY_STRING|REQUEST_BODY "@contains _POST[" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017438,rev:2,msg:'ET WEB_SERVER PHP POST SuperGlobal in URI',tag:'bad-unknown',tag:'url,imperva.com/download.asp?id=421'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:[&\?]_POST\[[^\]]+?\][^=]*?=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP POST SuperGlobal in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017439) ET WEB_SERVER PHP COOKIE SuperGlobal in URI
SecRule QUERY_STRING|REQUEST_BODY "@contains _COOKIE[" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017439,rev:2,msg:'ET WEB_SERVER PHP COOKIE SuperGlobal in URI',tag:'bad-unknown',tag:'url,imperva.com/download.asp?id=421'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:[&\?]_COOKIE\[[^\]]+?\][^=]*?=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP COOKIE SuperGlobal in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017440) ET WEB_SERVER PHP SESSION SuperGlobal in URI
SecRule QUERY_STRING|REQUEST_BODY "@contains _SESSION[" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017440,rev:2,msg:'ET WEB_SERVER PHP SESSION SuperGlobal in URI',tag:'bad-unknown',tag:'url,imperva.com/download.asp?id=421'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:[&\?]_SESSION\[[^\]]+?\][^=]*?=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP SESSION SuperGlobal in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017441) ET WEB_SERVER PHP REQUEST SuperGlobal in URI
SecRule QUERY_STRING|REQUEST_BODY "@contains _REQUEST[" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017441,rev:2,msg:'ET WEB_SERVER PHP REQUEST SuperGlobal in URI',tag:'bad-unknown',tag:'url,imperva.com/download.asp?id=421'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:[&\?]_REQUEST\[[^\]]+?\][^=]*?=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP REQUEST SuperGlobal in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017442) ET WEB_SERVER PHP ENV SuperGlobal in URI
SecRule QUERY_STRING|REQUEST_BODY "@contains _ENV[" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017442,rev:2,msg:'ET WEB_SERVER PHP ENV SuperGlobal in URI',tag:'bad-unknown',tag:'url,imperva.com/download.asp?id=421'"
SecRule QUERY_STRING|REQUEST_BODY "(?i:[&\?]_ENV\[[^\]]+?\][^=]*?=)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP ENV SuperGlobal in URI',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017443) ET WEB_SERVER PHP SERVER SuperGlobal in POST
SecRule QUERY_STRING|REQUEST_BODY "@contains _SERVER[" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017443,rev:2,msg:'ET WEB_SERVER PHP SERVER SuperGlobal in POST',tag:'bad-unknown',tag:'url,imperva.com/download.asp?id=421',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP SERVER SuperGlobal in POST',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017444) ET WEB_SERVER PHP GET SuperGlobal in POST
SecRule QUERY_STRING|REQUEST_BODY "@contains _GET[" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017444,rev:2,msg:'ET WEB_SERVER PHP GET SuperGlobal in POST',tag:'bad-unknown',tag:'url,imperva.com/download.asp?id=421',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP GET SuperGlobal in POST',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017445) ET WEB_SERVER PHP POST SuperGlobal in POST
SecRule QUERY_STRING|REQUEST_BODY "@contains _POST[" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017445,rev:2,msg:'ET WEB_SERVER PHP POST SuperGlobal in POST',tag:'bad-unknown',tag:'url,imperva.com/download.asp?id=421',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP POST SuperGlobal in POST',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017446) ET WEB_SERVER PHP COOKIE SuperGlobal in POST
SecRule QUERY_STRING|REQUEST_BODY "@contains _COOKIE[" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017446,rev:2,msg:'ET WEB_SERVER PHP COOKIE SuperGlobal in POST',tag:'bad-unknown',tag:'url,imperva.com/download.asp?id=421',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP COOKIE SuperGlobal in POST',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017447) ET WEB_SERVER PHP SESSION SuperGlobal in POST
SecRule QUERY_STRING|REQUEST_BODY "@contains _SESSION[" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017447,rev:2,msg:'ET WEB_SERVER PHP SESSION SuperGlobal in POST',tag:'bad-unknown',tag:'url,imperva.com/download.asp?id=421',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP SESSION SuperGlobal in POST',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017448) ET WEB_SERVER PHP REQUEST SuperGlobal in POST
SecRule QUERY_STRING|REQUEST_BODY "@contains _REQUEST[" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017448,rev:2,msg:'ET WEB_SERVER PHP REQUEST SuperGlobal in POST',tag:'bad-unknown',tag:'url,imperva.com/download.asp?id=421',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP REQUEST SuperGlobal in POST',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017449) ET WEB_SERVER PHP ENV SuperGlobal in POST
SecRule QUERY_STRING|REQUEST_BODY "@contains _ENV[" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017449,rev:2,msg:'ET WEB_SERVER PHP ENV SuperGlobal in POST',tag:'bad-unknown',tag:'url,imperva.com/download.asp?id=421',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER PHP ENV SuperGlobal in POST',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017528) ET WEB_SERVER UA WordPress, probable DDOS-Attack
SecRule QUERY_STRING|REQUEST_BODY "(?i:User\-Agent\\x3A\ Wordpress\/)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017528,rev:2,msg:'ET WEB_SERVER UA WordPress, probable DDOS-Attack',tag:'bad-unknown',tag:'url,pastebin.com/NP64hTQr',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER UA WordPress, probable DDOS-Attack',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017641) ET WEB_SERVER Possible Encrypted Webshell in POST
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017641,rev:3,msg:'ET WEB_SERVER Possible Encrypted Webshell in POST',tag:'bad-unknown',tag:'url,blog.sucuri.net/2013/10/backdoor-evasion-using-encrypted-content.html'"
SecRule QUERY_STRING|REQUEST_BODY "@contains eval" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains mcrypt_decrypt" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Encrypted Webshell in POST',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017734) ET WEB_SERVER WEBSHELL pwn.jsp shell
SecRule QUERY_STRING|REQUEST_BODY "@contains /pwn.jsp?" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017734,rev:4,msg:'ET WEB_SERVER WEBSHELL pwn.jsp shell',tag:'attempted-admin',tag:'url,blog.imperva.com/2013/11/threat-advisory-a-jboss-as-exploit-web-shell-code-injection.html'"
SecRule QUERY_STRING|REQUEST_BODY "@contains cmd=" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER WEBSHELL pwn.jsp shell',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017875) ET WEB_SERVER Coldfusion cfcexplorer Directory Traversal
SecRule QUERY_STRING|REQUEST_BODY "@contains /cfcexplorer.cfc" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017875,rev:2,msg:'ET WEB_SERVER Coldfusion cfcexplorer Directory Traversal',tag:'attempted-user',tag:'url,blog.spiderlabs.com/2013/12/the-curious-case-of-the-malicious-iis-module-prologue-method-of-entry-analysis.html'"
SecRule QUERY_STRING|REQUEST_BODY "@contains path=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:^[^&]*?(?:%(?:25)?2e(?:%(?:(?:25)?2e(?:%(?:25)?5c|\/|\\)|2e(?:25)?%(?:25)?2f)|\.(?:%(?:25)?(?:2f|5c)|\/|\\))|\.(?:%(?:25)?2e(?:%(?:25)?(?:2f|5c)|\/|\\)|\.(?:%(?:25)?(?:2f|5c)|\/|\\))))" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Coldfusion cfcexplorer Directory Traversal',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2017952) ET WEB_SERVER ATTACKER WebShell - PHP Offender - POST Command
SecRule QUERY_STRING|REQUEST_BODY "@contains work_dir=" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2017952,rev:1,msg:'ET WEB_SERVER ATTACKER WebShell - PHP Offender - POST Command',tag:'web-application-attack'"
SecRule QUERY_STRING|REQUEST_BODY "@contains command=" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains submit_btn=Execute+Command" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER ATTACKER WebShell - PHP Offender - POST Command',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2018056) ET WEB_SERVER Possible XXE SYSTEM ENTITY in POST BODY.
SecRule QUERY_STRING|REQUEST_BODY "@contains DOCTYPE" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2018056,rev:2,msg:'ET WEB_SERVER Possible XXE SYSTEM ENTITY in POST BODY.',tag:'trojan-activity'"
SecRule QUERY_STRING|REQUEST_BODY "@contains SYSTEM" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains ENTITY" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:^\s+?[^\s\>]+?\s+?SYSTEM\s)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible XXE SYSTEM ENTITY in POST BODY.',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2018092) ET WEB_SERVER Possible Oracle Reports Forms RCE CVE-2012-3152
SecRule QUERY_STRING|REQUEST_BODY "@contains /reports/rwservlet?" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2018092,rev:1,msg:'ET WEB_SERVER Possible Oracle Reports Forms RCE CVE-2012-3152',tag:'web-application-attack',tag:'url,netinfiltration.com'"
SecRule QUERY_STRING|REQUEST_BODY "@contains JOBTYPE" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains rwurl" "chain"
SecRule QUERY_STRING|REQUEST_BODY "@contains URLPARAMETER" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:URLPARAMETER\s*?=\s*?[\x22\x27]?(?:f(?:ile|tp)|gopher|https?|mailto)\s*?\x3a)" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Possible Oracle Reports Forms RCE CVE-2012-3152',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2018113) ET WEB_SERVER Apache Tomcat Boundary Overflow DOS/File Upload Attempt
SecRule QUERY_STRING|REQUEST_BODY "@contains POST" "chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2018113,rev:2,msg:'ET WEB_SERVER Apache Tomcat Boundary Overflow DOS/File Upload Attempt',tag:'web-application-attack',tag:'cve,2014-0050'"
SecRule QUERY_STRING|REQUEST_BODY "@contains multipart/form-data" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:Content\-Type\\x3A)" "chain"
SecRule QUERY_STRING|REQUEST_BODY "(?i:^[^\r\n]*?boundary\s*?=\s*?[^\r\n])" "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Apache Tomcat Boundary Overflow DOS/File Upload Attempt',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2018118) ET WEB_SERVER Recon-ng User-Agent
SecRule QUERY_STRING|REQUEST_BODY "(?i:User\-Agent\\x3a\ Recon\-ng)" "phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2018118,rev:1,msg:'ET WEB_SERVER Recon-ng User-Agent',tag:'attempted-recon',tag:'url,itbucket.org/LaNMaSteR53/recon-ng/overview',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER Recon-ng User-Agent',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


# (sid 2018202) ET WEB_SERVER log4jAdmin access from non-local network (can modify logging levels)
SecRule QUERY_STRING|REQUEST_BODY "@contains /log4jAdmin.jsp" "phase:2,pass,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',id:sid2018202,rev:2,msg:'ET WEB_SERVER log4jAdmin access from non-local network (can modify logging levels)',tag:'web-application-activity',tag:'url, gist.github.com/iamkristian/943918',ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SERVER log4jAdmin access from non-local network (can modify logging levels)',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}'"


SecMarker END_SNORT_RULES
